import{b as R,_ as j,c as H,d as Q,Q as K}from"./plugin-vue_export-helper.7e65a2c1.js";import{Q as S}from"./QInput.82080624.js";import{x as w,r as L,z as k,aa as z,aB as U,K as N,A,B as D,E as I,ab as O,U as V,n as M,aH as T,i as q,y as v,j as _,C as Y,D as G,l as J,Y as W,a as X,q as Z,s as ee,u as y,v as p,_ as $,$ as te}from"./index.0e477ee1.js";import{u as oe}from"./auth.9687cdf5.js";import"./pinia.cb76e820.js";var ue=w({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(n,{slots:g,emit:c}){const o=I(),u=L(null);let d=0;const i=[];function s(e){const m=typeof e=="boolean"?e:n.noErrorFocus!==!0,x=++d,E=(t,l)=>{c(`validation${t===!0?"Success":"Error"}`,l)},F=t=>{const l=t.validate();return typeof l.then=="function"?l.then(f=>({valid:f,comp:t}),f=>({valid:!1,comp:t,err:f})):Promise.resolve({valid:l,comp:t})};return(n.greedy===!0?Promise.all(i.map(F)).then(t=>t.filter(l=>l.valid!==!0)):i.reduce((t,l)=>t.then(()=>F(l).then(f=>{if(f.valid===!1)return Promise.reject(f)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return x===d&&E(!0),!0;if(x===d){const{comp:l,err:f}=t[0];if(f!==void 0&&console.error(f),E(!1,l),m===!0){const B=t.find(({comp:P})=>typeof P.focus=="function"&&O(P.$)===!1);B!==void 0&&B.comp.focus()}}return!1})}function a(){d++,i.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function r(e){e!==void 0&&V(e);const m=d+1;s().then(x=>{m===d&&x===!0&&(n.onSubmit!==void 0?c("submit",e):(e==null?void 0:e.target)!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function h(e){e!==void 0&&V(e),c("reset"),M(()=>{a(),n.autofocus===!0&&n.noResetFocus!==!0&&b()})}function b(){R(()=>{if(u.value===null)return;const e=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),m=>m.tabIndex!==-1);e==null||e.focus({preventScroll:!0})})}k(T,{bindComponent(e){i.push(e)},unbindComponent(e){const m=i.indexOf(e);m!==-1&&i.splice(m,1)}});let C=!1;return z(()=>{C=!0}),U(()=>{C===!0&&n.autofocus===!0&&b()}),N(()=>{n.autofocus===!0&&b()}),Object.assign(o.proxy,{validate:s,resetValidation:a,submit:r,reset:h,focus:b,getValidationComponents:()=>i}),()=>A("form",{class:"q-form",ref:u,onSubmit:r,onReset:h},D(g.default))}}),ae=w({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(n,{slots:g}){const{proxy:{$q:c}}=I(),o=q(Y,v);if(o===v)return console.error("QPage needs to be a deep child of QLayout"),v;if(q(G,v)===v)return console.error("QPage needs to be child of QPageContainer"),v;const d=_(()=>{const s=(o.header.space===!0?o.header.size:0)+(o.footer.space===!0?o.footer.size:0);if(typeof n.styleFn=="function"){const a=o.isContainer.value===!0?o.containerHeight.value:c.screen.height;return n.styleFn(s,a)}return{minHeight:o.isContainer.value===!0?o.containerHeight.value-s+"px":c.screen.height===0?s!==0?`calc(100vh - ${s}px)`:"100vh":c.screen.height-s+"px"}}),i=_(()=>`q-page${n.padding===!0?" q-layout-padding":""}`);return()=>A("main",{class:i.value,style:d.value},D(g.default))}});const ne=J({__name:"LoginPage",setup(n){const g=W(),c=H(),o=oe(),u=X({email:"",password:""}),d=async()=>{var s,a;try{await o.login(u.email,u.password),c.notify({type:"positive",message:"\u0423\u0441\u043F\u0435\u0448\u043D\u044B\u0439 \u0432\u0445\u043E\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043C\u0443",position:"top"}),await g.replace({name:"Dashboard"})}catch(r){const h=r;c.notify({type:"negative",message:((a=(s=h.response)==null?void 0:s.data)==null?void 0:a.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u0438",position:"top"})}},i=_(()=>o.loading);return(s,a)=>(Z(),ee(ae,{class:"flex flex-center"},{default:y(()=>[p(K,{class:"login-card"},{default:y(()=>[p(Q,null,{default:y(()=>a[2]||(a[2]=[$("div",{class:"text-h6"},"\u0412\u0445\u043E\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043C\u0443",-1)])),_:1,__:[2]}),p(Q,null,{default:y(()=>[p(ue,{onSubmit:d,class:"q-gutter-md"},{default:y(()=>[p(S,{modelValue:u.email,"onUpdate:modelValue":a[0]||(a[0]=r=>u.email=r),label:"Email",type:"email",rules:[r=>!!r||"Email \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u0435\u043D"]},null,8,["modelValue","rules"]),p(S,{modelValue:u.password,"onUpdate:modelValue":a[1]||(a[1]=r=>u.password=r),label:"\u041F\u0430\u0440\u043E\u043B\u044C",type:"password",rules:[r=>!!r||"\u041F\u0430\u0440\u043E\u043B\u044C \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u0435\u043D"]},null,8,["modelValue","rules"]),$("div",null,[p(te,{label:"\u0412\u043E\u0439\u0442\u0438",type:"submit",color:"primary",class:"full-width",loading:i.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1}))}});var fe=j(ne,[["__scopeId","data-v-1cc9a148"]]);export{fe as default};
