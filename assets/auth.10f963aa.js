import{u}from"./auth.33cb1534.js";import"./pinia.082cffec.js";import"./index.78c4b5c8.js";async function h(t,s,o){const e=u();if(!e.token&&localStorage.getItem("token")&&(e.token=localStorage.getItem("token")),t.name==="login"&&e.isAuthenticated)return o({name:"Dashboard"});const a=window.location.href.match(/\/admin\/([^\/#]+)/);if(a){const i=a[1];return await e.autoLogin(i)?o():o({name:"login"})}if(!e.token)return t.meta.requireAuth?o({name:"login"}):o();if(!e.user&&(await e.fetchUser(),!e.user))return o({name:"login"});const r=t.meta;if(r.roles&&!r.roles.some(n=>e.hasRole(n)))return o({name:"login"});o()}export{h as authGuard};
